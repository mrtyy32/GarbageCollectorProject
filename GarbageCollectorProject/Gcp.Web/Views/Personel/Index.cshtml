@{
    ViewBag.Title = "Personel Index";
    Layout = "~/Views/Shared/_panelLayout.cshtml";
}
@section pagescript{
    <script src="../assets/global/scripts/datatable.js" type="text/javascript"></script>
    <script src="../assets/global/plugins/datatables/datatables.min.js" type="text/javascript"></script>
    <script src="../assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js" type="text/javascript"></script>
    <script src="../assets/pages/scripts/table-datatables-responsive.js" type="text/javascript"></script>
    <script src="../assets/pages/scripts/ui-confirmations.js" type="text/javascript"></script>
    <script src="../assets/global/plugins/bootstrap-confirmation/bootstrap-confirmation.js" type="text/javascript"></script>
}
@section pagestyle{

    <link href="../assets/global/plugins/datatables/datatables.min.css" rel="stylesheet" type="text/css" />
    <link href="../assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet" type="text/css" />
}

<div class="row">

    <div class="col-md-12">
        <!-- BEGIN EXAMPLE TABLE PORTLET-->
        <div class="portlet light bordered">
            <div class="portlet-title">
                <div class="caption font-green">
                    <i class="icon-briefcase font-green"></i>
                    <span class="caption-subject bold uppercase">Personel Listesi &nbsp;</span>
                    <a @*href="Giris"*@ data-toggle="modal" data-target="#yeniKayit">
                        <span class="btn btn-xs btn-info">Yeni Kayıt</span>

                    </a>
                </div>
                <div class="tools"> </div>
            </div>
            <div class="portlet-body">
                <div id="sample_2_wrapper" class="dataTables_wrapper no-footer">

                    <div>
                        <table class="table table-striped table-bordered table-hover dt-responsive dataTable no-footer dtr-column collapsed" width="100%" id="sample_2" role="grid" aria-describedby="sample_2_info" style="width: 100%;">
                            <thead>
                                <tr role="row">
                                    <th id="detail" class="control sorting_disabled"></th>
                                    <th class="all sorting_asc">Ad</th>
                                    <th class="min-phone-l sorting">Soyad</th>
                                    <th class="min-tablet sorting">Pozisyon</th>
                                    <th class="none sorting">Giriş Tarihi</th>
                                    <th class="none sorting">Doğum Tarihi</th>
                                    <th class="none sorting">Vardiya</th>
                                    <th class="desktop sorting">Maaş</th>
                                    <th class="none sorting">Eğitim</th>
                                    <th>İşlemler</th>

                                </tr>
                            </thead>
                            <tbody id="tableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!-- END EXAMPLE TABLE PORTLET-->
    </div>
</div>
<input type="text" id="deneme" />


<!--MODALs-->

<div class="modal fade" id="yeniKayit" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Yeni Kayıt</h4>
            </div>
            <div class="modal-body">

                <div class="portlet light bordered">
                    <div class="portlet-title">
                        <div class="caption font-red-sunglo">
                            <i class="icon-settings font-red-sunglo"></i>
                            <span class="caption-subject bold uppercase"> Personel Ekleme Formu</span>
                        </div>

                    </div>
                    <div class="portlet-body form">

                        <div class="form-body">
                            <div class="form-group">
                                <label>Adı:</label>
                                <input id="pName" class="form-control spinner" type="text" placeholder="Personel Adı">
                            </div>

                            <div class="form-group">
                                <label>Soyadı:</label>
                                <input id="pLastName" class="form-control spinner" type="text" placeholder="Personel Soyadı">
                            </div>
                            <div class="form-group">
                                <label>Ünvan</label>
                                <select class="form-control">
                                    <option>Ünvan 1</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Maaş:</label>
                                <input id="pMaas" class="form-control spinner" type="number" placeholder="Personel Maaşı">
                            </div>
                            <div class="form-group">
                                <label>Eğitim</label>
                                <select class="form-control">
                                    <option>Eğitim 1</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Vardiya</label>
                                <select class="form-control">
                                    <option>Vardiya 1</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Doğum Tarihi:</label>
                                <input id="dogumTarihi" class="form-control spinner" type="datetime" placeholder="Doğum Tarihi">
                            </div>
                            <div class="form-group">
                                <label>Giriş Tarihi:</label>
                                <input id="girisTarihi" class="form-control spinner" type="date" placeholder="Giriş Tarihi">
                            </div>
                            <div class="form-group">
                                <label>Çıkış Tarihi:</label>
                                <input id="cikisTarihi" class="form-control spinner" type="date" placeholder="Çıkış Tarihi">
                            </div>
                            <div class="form-group">
                                <label>İzin Tarihi:</label>
                                <input id="izinTarihi" class="form-control spinner" type="date" placeholder="İzin Tarihi">
                            </div>
                        </div>
                        <div class="form-group">

                            <div class="mt-checkbox-list">
                                <label class="mt-checkbox">
                                    Çalışmıyor
                                    <input type="checkbox" value="0" name="calisma">
                                    <span></span>
                                </label>
                                <label class="mt-checkbox">
                                    Amir
                                    <input type="checkbox" value="1" name="amir">
                                    <span></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="modal-footer">
                <button data-bb-handler="ok" type="button" class="btn green" id="saveBtn">Kaydet</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Vazgeç</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="guncelleKayit" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Yeni Kayıt</h4>
            </div>
            <div class="modal-body">

                <div class="modal-body">

                    <div class="portlet light bordered">
                        <div class="portlet-title">
                            <div class="caption font-red-sunglo">
                                <i class="icon-settings font-red-sunglo"></i>
                                <span class="caption-subject bold uppercase"> Personel Güncelleme Formu</span>
                            </div>

                        </div>
                        <div class="portlet-body form">

                            <div class="form-body">
                                <div class="form-group">
                                    <label>Adı:</label>
                                    <input id="peditName" class="form-control spinner" type="text">
                                </div>

                                <div class="form-group">
                                    <label>Soyadı:</label>
                                    <input id="peditLastName" class="form-control spinner" type="text">
                                </div>
                                <div class="form-group">
                                    <label>Ünvan</label>
                                    <select class="form-control">
                                        <option>Ünvan 1</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Maaş:</label>
                                    <input id="peditMaas" class="form-control spinner" type="number">
                                </div>
                                <div class="form-group">
                                    <label>Eğitim</label>
                                    <select class="form-control">
                                        <option>Eğitim 1</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Vardiya</label>
                                    <select class="form-control">
                                        <option>Vardiya 1</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Doğum Tarihi:</label>
                                    <input id="editdogumTarihi" class="form-control spinner" type="date">
                                </div>
                                <div class="form-group">
                                    <label>Giriş Tarihi:</label>
                                    <input id="editgirisTarihi" class="form-control spinner" type="date">
                                </div>
                                <div class="form-group">
                                    <label>Çıkış Tarihi:</label>
                                    <input id="editcikisTarihi" class="form-control spinner" type="date">
                                </div>
                                <div class="form-group">
                                    <label>İzin Tarihi:</label>
                                    <input id="editizinTarihi" class="form-control spinner" type="date">
                                </div>
                            </div>
                            <div class="form-group">

                                <div class="mt-checkbox-list">
                                    <label class="mt-checkbox">
                                        Çalışmıyor
                                        <input type="checkbox" value="0" name="editcalisma">
                                        <span></span>
                                    </label>
                                    <label class="mt-checkbox">
                                        Amir
                                        <input type="checkbox" value="1" name="editamir">
                                        <span></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



            </div>
            <div class="modal-footer">
                <button data-bb-handler="ok" type="button" class="btn green" id="updateBtn">Güncelle</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Vazgeç</button>
            </div>
        </div>
    </div>
</div>


<script>
    getListe();
    var _url = "http://localhost:53723/api/Personel";
    function getListe() {

        $.ajax({
            url: "/Personel/GetPersonelHtml",
            success: (data) => {
                $("#tableBody").html(data);
            }
        });
    };
    function deletePersonel() {
        var id = $(this)[0].getAttribute('data-id');
        $.ajax({
            url: "/Personel/Delete/" + id,
            type: "POST",
            success: () => {
                getListe();
            }
        });

    };
    function editDoldur(data) {
        $("#peditName").val((data.PersonelAd));
        $("#peditLastName").val((data.PersonelSoyad));
        $("#editMaas").val((data.Maas));
        $("#editdogumTarihi").val((data.DogumTarihi));
        $("#editgirisTarihi").val((data.GirisTarihi));
        $("#editcikisTarihi").val((data.CikisTarihi));
        $("#editizinTarihi").val((data.izinTarihi));
        $("#editcalisma").val((data.CalismaDurumu));
        $("#editamir").val((data.AmirMi));
    };
    function getPersonel(id) {
        $.ajax({
            url: "/Personel/Edit/" + id,
            type: "GET",
            data: { id: id },
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: (data) => {
                editDoldur(data);
            }
        });
    };

    $("#saveBtn").click(() => {
        $.ajax({
            url: "/Personel/Create",
            type: "POST",
            data: {

                PersonelAd: $("#pName").val(),
                PersonelSoyAd: $("#pLastName").val(),
                UnvanID: $("#unvanID").val(),
                Maas: $("#pMaas").val(),
                DogumTarihi: $("#dogumTarihi").val(),
                GirisTarihi: $("#girisTarihi").val(),
                CikisTarihi: $("#cikisTarihi").val(),
                izinTarihi: $("#izinTarihi").val(),
                CalismaDurumu: $("#calisma").val(),
                AmirMi: $("#amir").val()

            },
            success: () => {
                getListe();
            }
        });
    });
    $("#updateBtn").click((id) => {
        $.ajax({
            url: "/Personel/Edit/" + id,
            type: "POST",
            data: {
                PersonelAd: $("#peditName").val(),
                PersonelSoyAd: $("#peditLastName").val(),
                UnvanID: $("#unvanID").val(),
                Maas: $("#editMaas").val(),
                DogumTarihi: $("#editdogumTarihi").val(),
                GirisTarihi: $("#editgirisTarihi").val(),
                CikisTarihi: $("#editcikisTarihi").val(),
                izinTarihi: $("#editizinTarihi").val(),
                CalismaDurumu: $("#editcalisma").val(),
                AmirMi: $("#editamir").val()
            },
            success: () => {
                getListe();
            }
        });
    });
</script>

